# ğŸ¤– Hummingbot é›†æˆæŒ‡å—

## ğŸ“Œ é‡è¦è¯´æ˜

**å½“å‰å®ç°äº†ä»€ä¹ˆï¼Ÿ**

âœ… **SaaS å¹³å°æ§åˆ¶é¢**ï¼ˆå·²å®Œæˆï¼‰ï¼š
- ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€è®¢é˜…ç®¡ç†
- ä¸ºæ¯ä¸ªç”¨æˆ·åˆ›å»ºç‹¬ç«‹çš„ Docker æ ˆ
- Bot ç®¡ç†æ¥å£ï¼ˆåˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ï¼‰
- å‘Šè­¦ã€å¤‡ä»½ã€å·¥å•ç³»ç»Ÿ
- è‡ªåŠ¨åŒ–è¿ç»´ï¼ˆç¼–æ’ã€å‡çº§ã€å›æ»šï¼‰

âŒ **Hummingbot äº¤æ˜“å¼•æ“**ï¼ˆéœ€è¦é›†æˆï¼‰ï¼š
- Hummingbot çš„å®é™…äº¤æ˜“é€»è¾‘
- Hummingbot Dashboard
- Hummingbot API

---

## ğŸ—ï¸ æ¶æ„è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æˆ‘ä»¬çš„ SaaS å¹³å°ï¼ˆPortalï¼‰                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ç”¨æˆ·ç®¡ç†ã€è®¢é˜…ã€Bot ç®¡ç†ã€å‘Šè­¦ã€å¤‡ä»½           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â”‚                               â”‚
â”‚                     â”‚ ç¼–æ’å’Œç®¡ç†                    â”‚
â”‚                     â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         å®¢æˆ·æ ˆï¼ˆæ¯ä¸ªç”¨æˆ·ç‹¬ç«‹ï¼‰                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  Hummingbot Containerï¼ˆå®˜æ–¹é•œåƒï¼‰       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ Hummingbot Coreï¼ˆäº¤æ˜“å¼•æ“ï¼‰        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ Hummingbot Gatewayï¼ˆå¯é€‰ï¼‰         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€ ç­–ç•¥è„šæœ¬                           â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚  â”‚  â”‚  Hummingbot Dashboardï¼ˆå®˜æ–¹é•œåƒï¼‰       â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”‚
â”‚  â”‚  â”‚  PostgreSQLï¼ˆç§Ÿæˆ·æ•°æ®åº“ï¼‰               â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æˆ‘ä»¬çš„å¹³å°ä½œç”¨**ï¼š
1. è‡ªåŠ¨ä¸ºæ¯ä¸ªç”¨æˆ·åˆ›å»ºå’Œç®¡ç†è¿™äº›å®¹å™¨
2. æä¾›ç»Ÿä¸€çš„ç”¨æˆ·ç•Œé¢å’Œ API
3. å¤„ç†è®¢é˜…ã€è®¡è´¹ã€å‘Šè­¦ã€å¤‡ä»½
4. ç›‘æ§å’Œç»´æŠ¤ Hummingbot å®ä¾‹

**Hummingbot ä½œç”¨**ï¼š
1. å®é™…æ‰§è¡Œäº¤æ˜“ç­–ç•¥
2. è¿æ¥äº¤æ˜“æ‰€
3. ç®¡ç†è®¢å•ã€ä»“ä½
4. æä¾› Dashboard å¯è§†åŒ–

---

## ğŸš€ é›†æˆæ­¥éª¤

### æ–¹å¼ 1ï¼šä½¿ç”¨å®˜æ–¹ Hummingbot Docker é•œåƒï¼ˆæ¨èï¼‰

#### æ­¥éª¤ 1ï¼šæ›´æ–°å®¢æˆ·æ ˆ Docker Compose æ¨¡æ¿

ç¼–è¾‘ `core/orchestrator.py` ä¸­çš„ `_get_default_compose_template()` æ–¹æ³•ï¼Œå·²ç»åŒ…å«äº† Hummingbot é•œåƒï¼š

```yaml
services:
  hummingbot-api:
    image: hummingbot/hummingbot:latest
    # ... å…¶ä»–é…ç½®
```

#### æ­¥éª¤ 2ï¼šé…ç½® Hummingbot

å®˜æ–¹ Hummingbot ä½¿ç”¨é…ç½®æ–‡ä»¶æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åˆ›å»º Bot æ—¶ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼š

```python
# åœ¨ core/orchestrator.py ä¸­æ·»åŠ 
def _generate_hummingbot_config(self, bot: Bot) -> dict:
    """ç”Ÿæˆ Hummingbot ç­–ç•¥é…ç½®"""

    if bot.strategy_template == StrategyTemplate.GRID:
        return {
            "strategy": "pure_market_making",  # æˆ– grid_trading
            "exchange": bot.exchange_connection.exchange_name,
            "market": bot.trading_pair,
            "order_amount": bot.strategy_config["order_amount"],
            "bid_spread": bot.strategy_config.get("bid_spread", 0.001),
            "ask_spread": bot.strategy_config.get("ask_spread", 0.001),
            # ... æ›´å¤šå‚æ•°
        }
```

#### æ­¥éª¤ 3ï¼šå¯åŠ¨ Hummingbot

```python
def start_hummingbot_bot(self, bot_id: str):
    """å¯åŠ¨ Hummingbot Bot"""

    with get_db() as db:
        bot = db.query(Bot).filter(Bot.id == bot_id).first()
        tenant = db.query(Tenant).filter(Tenant.id == bot.tenant_id).first()

        # 1. ç”Ÿæˆé…ç½®æ–‡ä»¶
        config = self._generate_hummingbot_config(bot)
        config_path = Path(tenant.deployment_path) / "configs" / f"{bot.id}.yml"

        with config_path.open('w') as f:
            yaml.dump(config, f)

        # 2. å¯åŠ¨ Hummingbot
        container_name = f"{tenant.tenant_code}-hummingbot"

        result = subprocess.run([
            "docker", "exec", container_name,
            "hummingbot", "start", "--script", f"{bot.id}.yml"
        ], capture_output=True, text=True)

        if result.returncode == 0:
            bot.status = BotStatus.RUNNING
            bot.started_at = datetime.utcnow()
            db.commit()
```

---

### æ–¹å¼ 2ï¼šä½¿ç”¨ Hummingbot Gatewayï¼ˆé«˜çº§ï¼‰

å¦‚æœéœ€è¦æ”¯æŒæ›´å¤šäº¤æ˜“æ‰€ï¼ˆç‰¹åˆ«æ˜¯ DEXï¼‰ï¼Œå¯ä»¥é›†æˆ Hummingbot Gatewayï¼š

```yaml
# åœ¨å®¢æˆ·æ ˆ compose ä¸­æ·»åŠ 
services:
  hummingbot-gateway:
    image: hummingbot/gateway:latest
    container_name: {{ tenant_code }}-gateway
    restart: unless-stopped
    environment:
      GATEWAY_PASSPHRASE: {{ gateway_passphrase }}
    volumes:
      - ./data/gateway:/home/gateway/conf
    networks:
      - tenant_network
    ports:
      - "15888:15888"
```

---

## ğŸ“ å®Œæ•´é›†æˆç¤ºä¾‹

### 1. åˆ›å»ºå®Œæ•´çš„å®¢æˆ·æ ˆé…ç½®

åˆ›å»ºæ–‡ä»¶ï¼š`core/templates/tenant-compose-with-hummingbot.yml.j2`

```yaml
version: '3.8'

services:
  # PostgreSQL
  postgres:
    image: postgres:15-alpine
    container_name: {{ tenant_code }}-postgres
    environment:
      POSTGRES_DB: hummingbot
      POSTGRES_USER: hummingbot
      POSTGRES_PASSWORD: {{ postgres_password }}
    volumes:
      - ./data/postgres:/var/lib/postgresql/data
    networks:
      - tenant_network

  # Redis
  redis:
    image: redis:7-alpine
    container_name: {{ tenant_code }}-redis
    command: redis-server --requirepass {{ redis_password }}
    volumes:
      - ./data/redis:/data
    networks:
      - tenant_network

  # Hummingbot Core
  hummingbot:
    image: hummingbot/hummingbot:{{ hummingbot_version }}
    container_name: {{ tenant_code }}-hummingbot
    restart: unless-stopped
    environment:
      CONFIG_FILE_NAME: conf_global.yml
      CONFIG_PASSWORD: {{ hummingbot_password }}
    volumes:
      - ./data/hummingbot:/home/hummingbot/conf
      - ./configs:/home/hummingbot/scripts
      - ./logs:/home/hummingbot/logs
    networks:
      - tenant_network
    depends_on:
      - postgres
      - redis

  # Hummingbot Dashboard
  dashboard:
    image: hummingbot/dashboard:{{ dashboard_version }}
    container_name: {{ tenant_code }}-dashboard
    restart: unless-stopped
    environment:
      HUMMINGBOT_INSTANCE_ID: {{ tenant_code }}
    volumes:
      - ./data/hummingbot:/home/hummingbot/conf:ro
    networks:
      - tenant_network
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.{{ tenant_code }}-dashboard.rule=Host(`{{ subdomain }}`)"
      - "traefik.http.routers.{{ tenant_code }}-dashboard.entrypoints=websecure"
      - "traefik.http.routers.{{ tenant_code }}-dashboard.tls.certresolver=letsencrypt"
    depends_on:
      - hummingbot

networks:
  tenant_network:
    driver: bridge
```

### 2. æ›´æ–° Bot å¯åŠ¨é€»è¾‘

ç¼–è¾‘ `api/main.py`ï¼Œåœ¨ `/bots/{bot_id}/start` æ¥å£ä¸­ï¼š

```python
@app.post("/bots/{bot_id}/start")
def start_bot(
    bot_id: str,
    current_user: User = Depends(get_current_user),
    db: Session = Depends(get_db_session)
):
    """å¯åŠ¨ Bot"""
    bot = db.query(Bot).filter(
        Bot.id == bot_id,
        Bot.user_id == current_user.id
    ).first()

    if not bot:
        raise HTTPException(
            status_code=status.HTTP_404_NOT_FOUND,
            detail="Bot not found"
        )

    # 1. è·å–äº¤æ˜“æ‰€å‡­è¯ï¼ˆè§£å¯†ï¼‰
    from core.encryption import EncryptionManager
    encryptor = EncryptionManager()

    exchange_conn = db.query(ExchangeConnection).filter(
        ExchangeConnection.id == bot.exchange_connection_id
    ).first()

    credentials = encryptor.decrypt_api_credentials({
        "encrypted_api_key": exchange_conn.encrypted_api_key,
        "encrypted_api_secret": exchange_conn.encrypted_api_secret,
        "nonce_key": exchange_conn.nonce_key,
        "nonce_secret": exchange_conn.nonce_secret,
    })

    # 2. ç”Ÿæˆ Hummingbot é…ç½®æ–‡ä»¶
    tenant = db.query(Tenant).filter(Tenant.id == bot.tenant_id).first()
    config_path = Path(tenant.deployment_path) / "configs" / f"{bot.id}.py"

    # ç”Ÿæˆç­–ç•¥è„šæœ¬
    strategy_script = generate_strategy_script(bot, credentials)
    config_path.write_text(strategy_script)

    # 3. å¯åŠ¨ Hummingbot Bot
    from core.orchestrator import TenantOrchestrator
    orchestrator = TenantOrchestrator()
    orchestrator.start_hummingbot_bot(bot.id)

    bot.status = BotStatus.STARTING
    bot.started_at = datetime.utcnow()
    db.commit()

    return {"message": "Bot is starting..."}
```

### 3. ç­–ç•¥è„šæœ¬ç”Ÿæˆå™¨

åˆ›å»ºæ–‡ä»¶ï¼š`core/strategy_generator.py`

```python
def generate_strategy_script(bot: Bot, credentials: dict) -> str:
    """
    ç”Ÿæˆ Hummingbot ç­–ç•¥è„šæœ¬

    Hummingbot æ”¯æŒä¸¤ç§æ–¹å¼ï¼š
    1. é…ç½®æ–‡ä»¶ï¼ˆYAMLï¼‰- é€‚åˆç®€å•ç­–ç•¥
    2. Python è„šæœ¬ - é€‚åˆå¤æ‚ç­–ç•¥
    """

    if bot.strategy_template == StrategyTemplate.GRID:
        return f"""
from hummingbot.strategy.pure_market_making import PureMarketMakingStrategy
from hummingbot.connector.exchange_base import ExchangeBase
from decimal import Decimal

class GridStrategy(PureMarketMakingStrategy):
    def __init__(self):
        super().__init__(
            exchange="{bot.exchange_connection.exchange_name}",
            market="{bot.trading_pair}",
            bid_spread=Decimal("{bot.strategy_config['bid_spread']}"),
            ask_spread=Decimal("{bot.strategy_config['ask_spread']}"),
            order_amount=Decimal("{bot.strategy_config['order_amount']}"),
            # ... æ›´å¤šå‚æ•°
        )

    # è‡ªå®šä¹‰é€»è¾‘
    def on_tick(self):
        # æ£€æŸ¥é£æ§
        if self.check_risk_limits():
            super().on_tick()
        else:
            self.logger.warning("Risk limits exceeded, stopping strategy")
            self.stop()

    def check_risk_limits(self):
        # æ£€æŸ¥æœ€å¤§ä»“ä½ã€æœ€å¤§äºæŸç­‰
        max_position = {bot.risk_config.get('max_position_usd', 10000)}
        current_position = self.get_position_value()
        return current_position < max_position

# è¿è¡Œç­–ç•¥
strategy = GridStrategy()
"""

    elif bot.strategy_template == StrategyTemplate.DCA:
        # DCA ç­–ç•¥è„šæœ¬
        pass

    elif bot.strategy_template == StrategyTemplate.SIGNAL_WEBHOOK:
        # Webhook ç­–ç•¥è„šæœ¬
        pass
```

---

## ğŸ”— å®˜æ–¹ Hummingbot èµ„æº

- **å®˜æ–¹æ–‡æ¡£**: https://docs.hummingbot.org
- **Docker é•œåƒ**: https://hub.docker.com/r/hummingbot/hummingbot
- **GitHub**: https://github.com/hummingbot/hummingbot
- **Discord ç¤¾åŒº**: https://discord.gg/hummingbot

---

## ğŸ“‹ æ£€æŸ¥æ¸…å•

åœ¨æ­£å¼ä¸Šçº¿å‰ï¼Œç¡®ä¿å®Œæˆä»¥ä¸‹é›†æˆï¼š

- [ ] æµ‹è¯• Hummingbot å®˜æ–¹é•œåƒå¯åŠ¨
- [ ] é…ç½®æ–‡ä»¶ç”Ÿæˆå’ŒåŠ è½½
- [ ] äº¤æ˜“æ‰€ API å‡­è¯æ³¨å…¥
- [ ] Bot å¯åŠ¨/åœæ­¢/é‡å¯åŠŸèƒ½
- [ ] å®æ—¶æ—¥å¿—æŸ¥çœ‹
- [ ] Dashboard è®¿é—®æƒé™æ§åˆ¶
- [ ] ç­–ç•¥æ¨¡æ¿éªŒè¯
- [ ] é£æ§å‚æ•°ç”Ÿæ•ˆ
- [ ] å‘Šè­¦é›†æˆï¼ˆHummingbot é”™è¯¯ â†’ æˆ‘ä»¬çš„å‘Šè­¦ç³»ç»Ÿï¼‰
- [ ] æ€§èƒ½æµ‹è¯•ï¼ˆå•ç§Ÿæˆ· / å¤šç§Ÿæˆ·ï¼‰

---

## ğŸ¯ å¿«é€Ÿæµ‹è¯•

### 1. æœ¬åœ°æµ‹è¯•å•ä¸ª Hummingbot å®ä¾‹

```bash
# å¯åŠ¨å®˜æ–¹ Hummingbot
docker run -it \
  --name my-hummingbot \
  -v $(pwd)/hummingbot_conf:/conf \
  -v $(pwd)/hummingbot_logs:/logs \
  hummingbot/hummingbot:latest

# è¿›å…¥å®¹å™¨
docker exec -it my-hummingbot bash

# è¿è¡Œç­–ç•¥
hummingbot
```

### 2. æµ‹è¯•é›†æˆåˆ°æˆ‘ä»¬çš„å¹³å°

```bash
# åˆ›å»ºæµ‹è¯•ç”¨æˆ·
curl -X POST http://localhost:8000/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "username": "testuser",
    "password": "password123"
  }'

# åˆ›å»ºç§Ÿæˆ·
curl -X POST http://localhost:8000/tenants/provision \
  -H "Authorization: Bearer <token>"

# åˆ›å»º Bot
curl -X POST http://localhost:8000/bots \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "bot_name": "Test Grid Bot",
    "exchange_connection_id": "<exchange_id>",
    "strategy_template": "grid",
    "strategy_config": {
      "lower_bound": 30000,
      "upper_bound": 35000,
      "grid_count": 10,
      "order_amount": 100
    },
    "trading_pair": "BTC-USDT"
  }'

# å¯åŠ¨ Bot
curl -X POST http://localhost:8000/bots/<bot_id>/start \
  -H "Authorization: Bearer <token>"
```

---

## âš ï¸ é‡è¦æç¤º

1. **Hummingbot ç‰ˆæœ¬å…¼å®¹æ€§**ï¼šå®šæœŸæ›´æ–° Docker é•œåƒç‰ˆæœ¬
2. **äº¤æ˜“æ‰€æ”¯æŒ**ï¼šç¡®è®¤ç›®æ ‡äº¤æ˜“æ‰€åœ¨ Hummingbot æ”¯æŒåˆ—è¡¨ä¸­
3. **èµ„æºé™åˆ¶**ï¼šHummingbot å†…å­˜å ç”¨çº¦ 512MB-1GB
4. **ç½‘ç»œå»¶è¿Ÿ**ï¼šäº¤æ˜“ç­–ç•¥å¯¹ç½‘ç»œå»¶è¿Ÿæ•æ„Ÿï¼Œå»ºè®®æœåŠ¡å™¨é è¿‘äº¤æ˜“æ‰€
5. **åˆè§„è¦æ±‚**ï¼šç¡®ä¿éµå®ˆå„äº¤æ˜“æ‰€ API ä½¿ç”¨è§„åˆ™

---

**ç°åœ¨ä½ å¯ä»¥å¼€å§‹é›†æˆ Hummingbot äº†ï¼** ğŸš€
